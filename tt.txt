using System;
using System.Runtime.InteropServices; // Do PlaySound
using System.Windows.Forms;
using WMPLib;      // Do ActiveX
using NAudio.Wave; // Do NAudio

namespace AudioTest
{
    public partial class Form1 : Form
    {
        // Model 1: PlaySound (WinAPI)
        [DllImport("winmm.dll")]
        static extern bool PlaySound(string pszSound, IntPtr hmod, uint fdwSound);

        // Model 2: ActiveX
        WindowsMediaPlayer wmp = new WindowsMediaPlayer();

        // Model 3: NAudio
        WaveOutEvent waveOut = new WaveOutEvent();
        AudioFileReader reader;

        public Form1()
        {
            InitializeComponent();
            // Ustawienia suwaka prędkości (od 0.5x do 2.0x)
            trackSpeed.Minimum = 5;
            trackSpeed.Maximum = 20;
            trackSpeed.Value = 10;
        }

        // --- OBSŁUGA PRZYCISKÓW ---

        private void btnPlaySound_Click(object sender, EventArgs e)
        {
            // PlaySound jest prymitywny - tylko pliki .wav
            PlaySound(@"C:\test.wav", IntPtr.Zero, 0x0001); 
        }

        private void btnActiveX_Click(object sender, EventArgs e)
        {
            wmp.URL = @"C:\test.mp3";
            wmp.settings.rate = trackSpeed.Value / 10.0; // Prędkość z suwaka
            wmp.controls.play();
        }

        private void btnNAudio_Click(object sender, EventArgs e)
        {
            if (reader != null) reader.Dispose();
            reader = new AudioFileReader(@"C:\test.mp3");
            waveOut.Init(reader);
            waveOut.Play();
        }

        private void btnStop_Click(object sender, EventArgs e)
        {
            wmp.controls.stop();
            waveOut.Stop();
            PlaySound(null, IntPtr.Zero, 0); // Zatrzymuje PlaySound
        }

        private void trackSpeed_Scroll(object sender, EventArgs e)
        {
            // Zmiana prędkości w locie dla ActiveX
            wmp.settings.rate = trackSpeed.Value / 10.0;
        }
    }
}